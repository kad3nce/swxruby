  <div id="C00000043">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />ClassMethods<br/>
  In:
<a href="#" onclick="jsHref('files/lib/swxruby/helper_module_rb.html');">lib/swxruby/helper_module.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000249&name=calculate_bytecode_length" >calculate_bytecode_length</a></li>
  <li><a href="index.html?a=M000250&name=generate_push_statement" >generate_push_statement</a></li>
  <li><a href="index.html?a=M000251&name=integer_to_hexadecimal" >integer_to_hexadecimal</a></li>
  <li><a href="index.html?a=M000252&name=make_little_endian" >make_little_endian</a></li>
  <li><a href="index.html?a=M000253&name=pad_string_to_byte_boundary" >pad_string_to_byte_boundary</a></li>
  <li><a href="index.html?a=M000254&name=string_length_in_bytes_hex" >string_length_in_bytes_hex</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M000249" class="method">
  <div id="M000249_title" class="title">
    <b>calculate_bytecode_length</b>(bytecode)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000249_source')" id="l_M000249_source">show source</a> ]</p>
  <div id="M000249_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/swxruby/helper_module.rb, line 23</span>
23:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_bytecode_length</span>(<span class="ruby-identifier">bytecode</span>)
24:                         <span class="ruby-comment cmt"># Calculate bytecode length *without* counting the init array or init object action</span>
25:                         <span class="ruby-identifier">bytecode</span>.<span class="ruby-identifier">join</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">/^(#{ActionCodes::INIT_ARRAY}|#{ActionCodes::INIT_OBJECT})/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">length</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>
26:                 <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000250" class="method">
  <div id="M000250_title" class="title">
    <b>generate_push_statement</b>(bytecode)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000250_source')" id="l_M000250_source">show source</a> ]</p>
  <div id="M000250_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/swxruby/helper_module.rb, line 28</span>
28:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate_push_statement</span>(<span class="ruby-identifier">bytecode</span>)
29:                         <span class="ruby-identifier">unpushed_data</span> = []
30:                         <span class="ruby-comment cmt"># Iterate over the bytecode array in reverse and add all of the unpushed</span>
31:                         <span class="ruby-comment cmt"># data to 'unpushed_data'</span>
32:                         <span class="ruby-identifier">bytecode</span>.<span class="ruby-identifier">reverse_each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">bytecode_chunk</span><span class="ruby-operator">|</span>
33:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">bytecode_chunk</span>.<span class="ruby-identifier">begins_with?</span>(<span class="ruby-value str">'96'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">bytecode_chunk</span>.<span class="ruby-identifier">begins_with?</span>(<span class="ruby-value str">'1D'</span>) <span class="ruby-keyword kw">then</span> <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">unpushed_data</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">bytecode_chunk</span> <span class="ruby-keyword kw">end</span>
34:                         <span class="ruby-keyword kw">end</span>
35:                         
36:                         <span class="ruby-comment cmt"># Since we iterated over the bytecode in reverse, unpushed_data is reversed, so </span>
37:                         <span class="ruby-comment cmt"># reverse it again before passing it into #calculate_bytecode_length</span>
38:                         <span class="ruby-identifier">bytecode_length</span> = <span class="ruby-identifier">calculate_bytecode_length</span>(<span class="ruby-identifier">unpushed_data</span>.<span class="ruby-identifier">reverse</span>)
39:                         
40:                          <span class="ruby-comment cmt"># TODO: Replace with constant</span>
41:                         <span class="ruby-value str">'96'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">integer_to_hexadecimal</span>(<span class="ruby-identifier">bytecode_length</span>, <span class="ruby-value">2</span>)
42:                 <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000251" class="method">
  <div id="M000251_title" class="title">
    <b>integer_to_hexadecimal</b>(integer, number_of_bytes=1)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000251_source')" id="l_M000251_source">show source</a> ]</p>
  <div id="M000251_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/swxruby/helper_module.rb, line 44</span>
44:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">integer_to_hexadecimal</span>(<span class="ruby-identifier">integer</span>, <span class="ruby-identifier">number_of_bytes</span>=<span class="ruby-value">1</span>)
45:                         <span class="ruby-identifier">make_little_endian</span>(<span class="ruby-node">&quot;%0#{number_of_bytes*2}X&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">integer</span>)
46:                 <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000252" class="method">
  <div id="M000252_title" class="title">
    <b>make_little_endian</b>(hex_string)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000252_source')" id="l_M000252_source">show source</a> ]</p>
  <div id="M000252_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/swxruby/helper_module.rb, line 48</span>
48:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">make_little_endian</span>(<span class="ruby-identifier">hex_string</span>)
49:                         <span class="ruby-comment cmt"># split into an array of string pairs</span>
50:                         <span class="ruby-comment cmt"># reverse the array and join back into a string</span>
51:                         <span class="ruby-identifier">pad_string_to_byte_boundary</span>(<span class="ruby-identifier">hex_string</span>).<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/../</span>).<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">join</span>
52:                 <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000253" class="method">
  <div id="M000253_title" class="title">
    <b>pad_string_to_byte_boundary</b>(hex_string)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000253_source')" id="l_M000253_source">show source</a> ]</p>
  <div id="M000253_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/swxruby/helper_module.rb, line 54</span>
54:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pad_string_to_byte_boundary</span>(<span class="ruby-identifier">hex_string</span>)
55:                         <span class="ruby-identifier">hex_string</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">'0'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hex_string</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
56:                         <span class="ruby-identifier">hex_string</span>
57:                 <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000254" class="method">
  <div id="M000254_title" class="title">
    <b>string_length_in_bytes_hex</b>(string, number_of_bytes)
  </div>
  <div class="description">
  <p>
Returns a string with the length of the passed hex string in bytes padded
to display in &#8216;number_of_bytes&#8217; bytes.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000254_source')" id="l_M000254_source">show source</a> ]</p>
  <div id="M000254_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/swxruby/helper_module.rb, line 61</span>
61:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">string_length_in_bytes_hex</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">number_of_bytes</span>)
62:                                                                                                                                                                                                                  <span class="ruby-comment cmt"># Divide length in chars by 2 to get length in bytes</span>
63:                         <span class="ruby-identifier">bytecode_length_in_hex</span> = <span class="ruby-identifier">integer_to_hexadecimal</span>(<span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>, <span class="ruby-identifier">number_of_bytes</span>)
64:                 <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>